# Branching history

````admonish reset title="Reset your progress" collapsible=true
To reset your progress to the start of this chapter, run the following command:

```sh
curl https://s2p2.github.io/jj-for-everyone/reset.sh | bash -s branch
cd ~/jj-tutorial/repo
```
````

So far, we've worked solo. Let's simulate a collaboration to see how Jujutsu handles branching.

Two developers, Alice and Bob, are working on a project.
- Alice will add a `hello.py` script.
- Bob will update `README.md`.

First, Alice creates `hello.py`:

```sh
echo 'print("Hello, world!")' > hello.py
```

And makes a commit:

```sh
jj commit -m "Add Python script for greeting the world

Printing the text \"Hello, world!\" is a classic exercise in introductory
programming courses. It's easy to complete in basically any language and
makes students feel accomplished and curious for more at the same time."
```

Run `jj log`:

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">s</span><span class="bold highlighted dimgray ">vplvpro</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-07-22 21:17:41</span><span class="bold "> </span><span class="bold highlighted blue ">4</span><span class="bold highlighted dimgray ">db2d0d0</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
○  <span class="bold "></span><span class="bold purple ">z</span><span class="highlighted dimgray ">zywylnt</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-07-22 21:17:31</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">f8</span><span class="highlighted dimgray ">e44920</span>
│  Add Python script for greeting the world
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">k</span><span class="highlighted dimgray ">xqyrwux</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-07-22 21:14:46</span> <span class="purple ">main</span> <span class="bold "></span><span class="bold blue ">ff</span><span class="highlighted dimgray ">df52d0</span>
│  Add project description to readme
~
</pre>

Meanwhile, Bob works on a separate clone of the repository, unaware of Alice's new commit. We'll simulate this by cloning the remote again and configuring it for Bob.

```sh
jj git clone ~/jj-tutorial/remote ~/jj-tutorial/repo-bob
cd ~/jj-tutorial/repo-bob
jj config set --repo user.name Bob
jj config set --repo user.email bob@local
jj metaedit --update-author
jj log
```

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">q</span><span class="bold highlighted dimgray ">uolxwkk</span><span class="bold "> </span><span class="bold yellow ">bob@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-07-22 21:19:11</span><span class="bold "> </span><span class="bold highlighted blue ">3</span><span class="bold highlighted dimgray ">ffac111</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">k</span><span class="highlighted dimgray ">xqyrwux</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-07-22 21:14:46</span> <span class="purple ">main</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">f</span><span class="highlighted dimgray ">fdf52d0</span>
│  Add project description to readme
~
</pre>

Bob updates the `README.md`, commits his changes, and pushes to `main` first:

```sh
echo "# jj-tutorial

The file hello.py contains a script that greets the world.
It can be executed with the command 'python hello.py'.
Programming is fun!" > README.md

jj commit -m "Document hello.py in README.md

The file hello.py doesn't exist yet, because Alice is working on that.
Once our changes are combined, this documentation will be accurate."

jj bookmark move main --to @-
jj git push
```

A little later, Alice finishes her work and tries to push, but it fails because the remote `main` bookmark has moved.

```sh
cd ~/jj-tutorial/repo
jj bookmark move main --to @-
jj git push
```

<!-- generated by aha script -->
<pre class="aha">
Changes to push to origin:
  Move forward bookmark main from cd5f3fff9c7b to e90b597ed78e
<span class="bold "></span><span class="bold red ">Error: </span><span class="bold ">Failed to push some bookmarks</span>
<span class="bold "></span><span class="bold cyan ">Hint: </span>The following references unexpectedly moved on the remote:
  <span class="green ">refs/heads/main</span> (reason: stale info)
<span class="bold "></span><span class="bold cyan ">Hint: </span>Try fetching from the remote, then make the bookmark point to where
       ↪ you want it to be, and push again.
</pre>

Following the error's hint, Alice fetches the latest changes. `jj git fetch` downloads new commits and bookmarks from the remote.

```sh
jj git fetch
```

After fetching, her log shows that the history has diverged into two **branches**:

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">s</span><span class="bold highlighted dimgray ">vplvpro</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-07-22 21:17:41</span><span class="bold "> </span><span class="bold highlighted blue ">4</span><span class="bold highlighted dimgray ">db2d0d0</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
○  <span class="bold "></span><span class="bold purple ">z</span><span class="highlighted dimgray ">zywylnt</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-07-22 21:17:31</span> <span class="purple ">main?? main@git</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">f8</span><span class="highlighted dimgray ">e44920</span>
│  Add Python script for greeting the world
│ <span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">q</span><span class="highlighted dimgray ">uolxwkk</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-07-22 21:22:22</span> <span class="purple ">main?? main@origin</span> <span class="bold "></span><span class="bold blue ">8</span><span class="highlighted dimgray ">d538390</span>
├─╯  Document hello.py in README.md
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">k</span><span class="highlighted dimgray ">xqyrwux</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-07-22 21:14:46</span> <span class="bold "></span><span class="bold blue ">ff</span><span class="highlighted dimgray ">df52d0</span>
│  Add project description to readme
~
</pre>

This happened because Alice and Bob both created new commits based on the same parent. Jujutsu prevented Alice's push to stop her from accidentally overwriting Bob's work.

Notice the `main` bookmark appears twice with question marks (`??`). This conflict means Jujutsu doesn't know where `main` should point: to Alice's local commit or Bob's commit from the remote.

```admonish info title="Confusing terms: bookmark and branch"
- A **bookmark** is a named pointer to a single commit.
- A **branch** is specified by its **tip**, which is also a single commit.
However, a branch refers to the **set of commits** that includes the tip and **all of its ancestors**.

A bookmark often names the tip of a branch. For example, the `main` bookmark points to the tip of what we call "the main branch". People who primarily use Git often use the word "branch" for both concepts.
```

To proceed, Alice and Bob need to combine their changes into a single version. We'll cover how in the next chapter.
