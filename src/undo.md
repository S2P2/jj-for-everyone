# Undoing mistakes

````admonish reset title="Reset your progress" collapsible=true
To reset your progress to the start of this chapter, run the following command:

```sh
curl https://jj-for-everyone.github.io/reset.sh | bash -s undo
cd ~/jj-tutorial/repo
```
````

Jujutsu keeps a log of every operation performed on the repository, not just the commit history. This lets you easily undo mistakes.

For example, let's fix a hastily written commit message. First, we'll check our current state.

```sh
cd ~/jj-tutorial/repo
jj log
```

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">p</span><span class="bold highlighted dimgray ">zsymsll</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-09-10 20:52:56</span><span class="bold "> </span><span class="bold highlighted blue ">1</span><span class="bold highlighted dimgray ">be9c292</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">l</span><span class="highlighted dimgray ">yquuqkl</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">main</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">2</span><span class="highlighted dimgray ">ae165d3</span>
│  Add submission instructions
│ ○  <span class="bold "></span><span class="bold purple ">v</span><span class="highlighted dimgray ">tnrtqsn</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">push-vtnrtqsnrzqx</span> <span class="bold "></span><span class="bold blue ">d</span><span class="highlighted dimgray ">517a86d</span>
├─╯  WIP: Add for loop (need to fix syntax)
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">t</span><span class="highlighted dimgray ">lwyrrmy</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="bold "></span><span class="bold blue ">f</span><span class="highlighted dimgray ">fc6841f</span>
│  <span class="green ">(empty)</span> Merge code and documentation for hello-world
~
</pre>

## Making a Mistake

Let's add more greetings and create a commit with a poor description.

```sh
echo 'print("Hallo, Welt!")' >> hello.py
echo 'print("Bonjour, le monde!")' >> hello.py
jj commit -m "code improvements"
```

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">y</span><span class="bold highlighted dimgray ">xmkmosm</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-09-10 20:53:46</span><span class="bold "> </span><span class="bold highlighted blue ">d2</span><span class="bold highlighted dimgray ">8a8261</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
○  <span class="bold "></span><span class="bold purple ">p</span><span class="highlighted dimgray ">zsymsll</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:53:46</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">0</span><span class="highlighted dimgray ">50b543b</span>
│  code improvements
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">l</span><span class="highlighted dimgray ">yquuqkl</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">main</span> <span class="bold "></span><span class="bold blue ">2</span><span class="highlighted dimgray ">ae165d3</span>
│  Add submission instructions
│ ○  <span class="bold "></span><span class="bold purple ">v</span><span class="highlighted dimgray ">tnrtqsn</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">push-vtnrtqsnrzqx</span> <span class="bold "></span><span class="bold blue ">d5</span><span class="highlighted dimgray ">17a86d</span>
├─╯  WIP: Add for loop (need to fix syntax)
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">t</span><span class="highlighted dimgray ">lwyrrmy</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="bold "></span><span class="bold blue ">f</span><span class="highlighted dimgray ">fc6841f</span>
│  <span class="green ">(empty)</span> Merge code and documentation for hello-world
~
</pre>

## Undoing the mistake

To fix this, we restore the repository to its previous state with `jj undo`.

```sh
jj undo
```

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">p</span><span class="bold highlighted dimgray ">zsymsll</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-09-10 20:53:46</span><span class="bold "> </span><span class="bold highlighted blue ">9</span><span class="bold highlighted dimgray ">4a7ca39</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold yellow ">(no description set)</span><span class="bold "></span>
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">l</span><span class="highlighted dimgray ">yquuqkl</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">main</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">2</span><span class="highlighted dimgray ">ae165d3</span>
│  Add submission instructions
│ ○  <span class="bold "></span><span class="bold purple ">v</span><span class="highlighted dimgray ">tnrtqsn</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">push-vtnrtqsnrzqx</span> <span class="bold "></span><span class="bold blue ">d</span><span class="highlighted dimgray ">517a86d</span>
├─╯  WIP: Add for loop (need to fix syntax)
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">t</span><span class="highlighted dimgray ">lwyrrmy</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="bold "></span><span class="bold blue ">f</span><span class="highlighted dimgray ">fc6841f</span>
│  <span class="green ">(empty)</span> Merge code and documentation for hello-world
~
</pre>

We're back to the state before the bad commit. Now we can commit again with a better message.

```sh
jj commit -m "Print German and French greetings as well"
```

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">n</span><span class="bold highlighted dimgray ">pnpqkvz</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-09-10 20:54:33</span><span class="bold "> </span><span class="bold highlighted blue ">8</span><span class="bold highlighted dimgray ">f11c4f5</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
○  <span class="bold "></span><span class="bold purple ">p</span><span class="highlighted dimgray ">zsymsll</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:54:33</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">df</span><span class="highlighted dimgray ">82ee49</span>
│  Print German and French greetings as well
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">l</span><span class="highlighted dimgray ">yquuqkl</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">main</span> <span class="bold "></span><span class="bold blue ">2</span><span class="highlighted dimgray ">ae165d3</span>
│  Add submission instructions
│ ○  <span class="bold "></span><span class="bold purple ">v</span><span class="highlighted dimgray ">tnrtqsn</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">push-vtnrtqsnrzqx</span> <span class="bold "></span><span class="bold blue ">d5</span><span class="highlighted dimgray ">17a86d</span>
├─╯  WIP: Add for loop (need to fix syntax)
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">t</span><span class="highlighted dimgray ">lwyrrmy</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="bold "></span><span class="bold blue ">f</span><span class="highlighted dimgray ">fc6841f</span>
│  <span class="green ">(empty)</span> Merge code and documentation for hello-world
~
</pre>

## Undoing and Redoing Multiple Operations

`jj undo` works like <kbd>Ctrl+Z</kbd>; you can run it multiple times to go further back. It even undoes file system changes, because `jj` snapshots your workspace before running a command.

Let's undo the last three operations: the good commit, the file modifications, and the `jj new main` command from the previous chapter.

the good commit:
```sh
jj undo
```

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">p</span><span class="bold highlighted dimgray ">zsymsll</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-09-10 20:53:46</span><span class="bold "> </span><span class="bold highlighted blue ">9</span><span class="bold highlighted dimgray ">4a7ca39</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold yellow ">(no description set)</span><span class="bold "></span>
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">l</span><span class="highlighted dimgray ">yquuqkl</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">main</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">2</span><span class="highlighted dimgray ">ae165d3</span>
│  Add submission instructions
│ ○  <span class="bold "></span><span class="bold purple ">v</span><span class="highlighted dimgray ">tnrtqsn</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">push-vtnrtqsnrzqx</span> <span class="bold "></span><span class="bold blue ">d</span><span class="highlighted dimgray ">517a86d</span>
├─╯  WIP: Add for loop (need to fix syntax)
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">t</span><span class="highlighted dimgray ">lwyrrmy</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="bold "></span><span class="bold blue ">f</span><span class="highlighted dimgray ">fc6841f</span>
│  <span class="green ">(empty)</span> Merge code and documentation for hello-world
~
</pre>

the file modifications:
```py
# hello.py
print("Hello, world!")
print("Hallo, Welt!")
print("Bonjour, le monde!")
```

```sh
jj undo
```

```py
# hello.py
print("Hello, world!")
```

`jj log` to check:

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">p</span><span class="bold highlighted dimgray ">zsymsll</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-09-10 20:52:56</span><span class="bold "> </span><span class="bold highlighted blue ">1</span><span class="bold highlighted dimgray ">be9c292</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">l</span><span class="highlighted dimgray ">yquuqkl</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">main</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">2</span><span class="highlighted dimgray ">ae165d3</span>
│  Add submission instructions
│ ○  <span class="bold "></span><span class="bold purple ">v</span><span class="highlighted dimgray ">tnrtqsn</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">push-vtnrtqsnrzqx</span> <span class="bold "></span><span class="bold blue ">d</span><span class="highlighted dimgray ">517a86d</span>
├─╯  WIP: Add for loop (need to fix syntax)
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">t</span><span class="highlighted dimgray ">lwyrrmy</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="bold "></span><span class="bold blue ">f</span><span class="highlighted dimgray ">fc6841f</span>
│  <span class="green ">(empty)</span> Merge code and documentation for hello-world
~
</pre>

One last time: `jj new main` command from the previous chapter.

```
jj undo
```

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">w</span><span class="bold highlighted dimgray ">kqpyqlm</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-09-10 20:52:56</span><span class="bold "> </span><span class="bold highlighted blue ">64</span><span class="bold highlighted dimgray ">0e22bf</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
│ <span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">l</span><span class="highlighted dimgray ">yquuqkl</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">main</span> <span class="bold "></span><span class="bold blue ">2</span><span class="highlighted dimgray ">ae165d3</span>
│ │  Add submission instructions
│ │ ○  <span class="bold "></span><span class="bold purple ">v</span><span class="highlighted dimgray ">tnrtqsn</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">push-vtnrtqsnrzqx</span> <span class="bold "></span><span class="bold blue ">d</span><span class="highlighted dimgray ">517a86d</span>
│ ├─╯  WIP: Add for loop (need to fix syntax)
│ <span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">t</span><span class="highlighted dimgray ">lwyrrmy</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="bold "></span><span class="bold blue ">f</span><span class="highlighted dimgray ">fc6841f</span>
╭─┤  <span class="green ">(empty)</span> Merge code and documentation for hello-world
│ │
│ ~
│
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">u</span><span class="highlighted dimgray ">vxzzlmr</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-09-10 20:52:55</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">60</span><span class="highlighted dimgray ">e09461</span>
│  Document hello.py in README.md
~
</pre>

The `jj redo` command re-applies undone operations, like <kbd>Ctrl+Shift+Z</kbd>. Let's use it to get back to our most recent state.

```sh
jj redo
jj redo
jj redo
```

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">n</span><span class="bold highlighted dimgray ">pnpqkvz</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-09-10 20:54:33</span><span class="bold "> </span><span class="bold highlighted blue ">8</span><span class="bold highlighted dimgray ">f11c4f5</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
○  <span class="bold "></span><span class="bold purple ">p</span><span class="highlighted dimgray ">zsymsll</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:54:33</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">df</span><span class="highlighted dimgray ">82ee49</span>
│  Print German and French greetings as well
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">l</span><span class="highlighted dimgray ">yquuqkl</span> <span class="yellow ">bob@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">main</span> <span class="bold "></span><span class="bold blue ">2</span><span class="highlighted dimgray ">ae165d3</span>
│  Add submission instructions
│ ○  <span class="bold "></span><span class="bold purple ">v</span><span class="highlighted dimgray ">tnrtqsn</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="purple ">push-vtnrtqsnrzqx</span> <span class="bold "></span><span class="bold blue ">d5</span><span class="highlighted dimgray ">17a86d</span>
├─╯  WIP: Add for loop (need to fix syntax)
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">t</span><span class="highlighted dimgray ">lwyrrmy</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-09-10 20:52:56</span> <span class="bold "></span><span class="bold blue ">f</span><span class="highlighted dimgray ">fc6841f</span>
│  <span class="green ">(empty)</span> Merge code and documentation for hello-world
~
</pre>

Try `jj redo` one more time, you'd get an error that there's nothing to redo.

## Important Considerations

*   **Overwriting History:** If you `undo` operations and then create a new one, the undone states become inaccessible via `jj redo`. This is similar to standard undo/redo stacks. However, unlike most graphical applications, Jujutsu has advanced commands to recover these "hidden" states, which is a topic for another day.

*   **Remote Operations:** Do not `jj undo` a push operation (e.g., `jj git push`). It only affects your local repository and can cause conflicts with the remote. If you do it by accident, immediately `jj redo` it.

*   **Local History:** The operation log is local to your machine and is not cloned or pushed. `jj undo` only works on the history created in your local repository clone.
